name = "corporate-fixes-publisher"
main = "src/index.ts"
compatibility_date = "2026-02-25"

# Deploy this worker on the same Cloudflare zone that fronts your GitHub Pages site.
# Example route protects publishing under the site hostname while your static site remains on GitHub Pages.
routes = [
  { pattern = "tamemj.com/api/corporate-tech-fixes/publish", zone_name = "tamemj.com" }
]

[vars]
GITHUB_OWNER = "your-github-username-or-org"
GITHUB_REPO = "your-repo-name"
GITHUB_BRANCH = "main"
GITHUB_PUBLISHED_FIXES_PATH = "data/corporate-fixes.published.json"
PUBLISH_PATH = "/api/corporate-tech-fixes/publish"

# Optional but recommended for browser CORS restrictions if you call from a different origin.
# Comma-separated.
ALLOWED_ORIGINS = "https://tamemj.com,https://www.tamemj.com"

# Optional extra restriction in addition to Cloudflare Access policy.
# Comma-separated lowercase emails.
# ALLOWED_EMAILS = "you@example.com"

# Keep true unless you intentionally want unauthenticated access for testing.
REQUIRE_CLOUDFLARE_ACCESS = "true"

# Optional Git commit identity shown in GitHub history.
GIT_COMMIT_NAME = "Corporate Fixes Publisher"
GIT_COMMIT_EMAIL = "noreply@tamemj.com"

# Required secrets (set with `wrangler secret put`):
# - GITHUB_TOKEN (fine-grained PAT or GitHub App installation token generator setup)
